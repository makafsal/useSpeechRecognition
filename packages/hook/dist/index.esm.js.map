{"version":3,"file":"index.esm.js","sources":["../src/useSpeechRecognition.ts"],"sourcesContent":["import { useCallback, useEffect, useRef, useState } from \"react\";\n\ninterface SpeechRecognitionHook {\n  onStart: () => void;\n  onStop: () => void;\n  isListening: boolean;\n  errorMessage: string;\n  result: string;\n}\n\nconst ERR = \"SpeechRecognition API is not supported in this browser.\";\n\nexport const useSpeechRecognition = (commands = []): SpeechRecognitionHook => {\n  const recognitionRef = useRef<any>(null);\n  // State\n  const [isListening, setIsListening] = useState(false);\n  const [errorMessage, setErrorMessage] = useState(\"\");\n  const [result, setResult] = useState(\"\");\n\n  const grammar = `#JSGF V1.0; grammar commands; public <command> = ${commands.join(\n    \" | \"\n  )};`;\n  const onStop = useCallback(() => {\n    recognitionRef?.current.stop();\n    setIsListening(false);\n  }, []);\n\n  const onStart = useCallback(() => {\n    if (isListening) {\n      onStop();\n      return;\n    }\n\n    setErrorMessage(\"\");\n    setResult(\"\");\n\n    recognitionRef?.current.start();\n    setIsListening(true);\n\n    setTimeout(() => onStop(), 8000);\n  }, [isListening, onStop]);\n\n  const onResult = (event: any) => {\n    const command = event.results[0][0].transcript;\n    setResult(command);\n    onStop();\n  };\n\n  const onError = (event: any) => {\n    setErrorMessage(\"No voice detected.\");\n    onStop();\n  };\n\n  useEffect(() => {\n    const _window = window as any;\n    const SpeechRecognition =\n      _window?.SpeechRecognition || _window?.webkitSpeechRecognition;\n\n    const SpeechGrammarList =\n      _window?.SpeechGrammarList || _window?.webkitSpeechGrammarList;\n\n    if (SpeechRecognition) {\n      recognitionRef.current = new SpeechRecognition();\n\n      const speechRecognitionList = new SpeechGrammarList();\n\n      speechRecognitionList.addFromString(grammar, 1);\n\n      recognitionRef.current.grammars = speechRecognitionList;\n      recognitionRef.current.continuous = false;\n      recognitionRef.current.lang = \"en-US\";\n      recognitionRef.current.interimResults = false;\n      recognitionRef.current.maxAlternatives = 1;\n      recognitionRef.current.onerror = (event: any) => onError(event);\n      recognitionRef.current.onresult = (event: any) => onResult(event);\n    }\n  }, []);\n\n  if (!recognitionRef?.current) {\n    console.error(ERR);\n\n    return {\n      onStart,\n      onStop,\n      isListening,\n      errorMessage: ERR,\n      result\n    };\n  }\n\n  return {\n    onStart,\n    onStop,\n    isListening,\n    errorMessage,\n    result\n  };\n};\n"],"names":["ERR","useSpeechRecognition","commands","recognitionRef","useRef","isListening","setIsListening","useState","errorMessage","setErrorMessage","result","setResult","grammar","join","onStop","useCallback","current","stop","onStart","start","setTimeout","useEffect","_window","window","SpeechRecognition","webkitSpeechRecognition","SpeechGrammarList","webkitSpeechGrammarList","speechRecognitionList","addFromString","grammars","continuous","lang","interimResults","maxAlternatives","onerror","event","onresult","command","results","transcript","onResult","console","error"],"mappings":"6EAUA,MAAMA,EAAM,0DAECC,EAAuB,CAACC,EAAW,MAC9C,MAAMC,EAAiBC,EAAY,OAE5BC,EAAaC,GAAkBC,GAAS,IACxCC,EAAcC,GAAmBF,EAAS,KAC1CG,EAAQC,GAAaJ,EAAS,IAE/BK,EAAU,oDAAoDV,EAASW,KAC3E,UAEIC,EAASC,GAAY,KACzBZ,GAAgBa,QAAQC,OACxBX,GAAe,EAAM,GACpB,IAEGY,EAAUH,GAAY,KACtBV,EACFS,KAIFL,EAAgB,IAChBE,EAAU,IAEVR,GAAgBa,QAAQG,QACxBb,GAAe,GAEfc,YAAW,IAAMN,KAAU,KAAK,GAC/B,CAACT,EAAaS,IAsCjB,OAzBAO,GAAU,KACR,MAAMC,EAAUC,OACVC,EACJF,GAASE,mBAAqBF,GAASG,wBAEnCC,EACJJ,GAASI,mBAAqBJ,GAASK,wBAEzC,GAAIH,EAAmB,CACrBrB,EAAea,QAAU,IAAIQ,EAE7B,MAAMI,EAAwB,IAAIF,EAElCE,EAAsBC,cAAcjB,EAAS,GAE7CT,EAAea,QAAQc,SAAWF,EAClCzB,EAAea,QAAQe,YAAa,EACpC5B,EAAea,QAAQgB,KAAO,QAC9B7B,EAAea,QAAQiB,gBAAiB,EACxC9B,EAAea,QAAQkB,gBAAkB,EACzC/B,EAAea,QAAQmB,QAAWC,IAxBpC3B,EAAgB,2BAChBK,KAwBEX,EAAea,QAAQqB,SAAYD,GAhCtB,CAACA,IAChB,MAAME,EAAUF,EAAMG,QAAQ,GAAG,GAAGC,WACpC7B,EAAU2B,GACVxB,GAAQ,EA6B4C2B,CAASL,EAC5D,IACA,IAEEjC,GAAgBa,QAYd,CACLE,UACAJ,SACAT,cACAG,eACAE,WAhBAgC,QAAQC,MAAM3C,GAEP,CACLkB,UACAJ,SACAT,cACAG,aAAcR,EACdU,UAUH"}